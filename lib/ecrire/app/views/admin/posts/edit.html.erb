<header>
  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class='toggle', as='Navigation.Toggle' x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve">
    <path d="M4.516,7.548c0.436-0.446,1.043-0.481,1.576,0L10,11.295l3.908-3.747c0.533-0.481,1.141-0.446,1.574,0  c0.436,0.445,0.408,1.197,0,1.615c-0.406,0.418-4.695,4.502-4.695,4.502C10.57,13.888,10.285,14,10,14s-0.57-0.112-0.789-0.335  c0,0-4.287-4.084-4.695-4.502C4.107,8.745,4.08,7.993,4.516,7.548z"/>
  </svg>

  <%= form_for @post,
    as: 'post',
    remote: true,
    html: {as: 'Posts.Title', class: %w(post title settings autosave)} do |f| %>
    <%= hidden_field_tag :context, :title %>

    <%= f.text_field :title, class: %w(title), autocomplete: :off %>
  <% end %>
</header>

<section as='Post.Documentation'>

  <%= content_tag :div, class: %w(publish state), href: admin_post_path(@post.id), as: 'Post.Sticky' do %>

    <% if @post.published? %>

      <%= form_for @post, method: :put, html: { class: %w(hide button destroy) } do |f| %>
        <%= f.button 'Retract', value: 'unpublish'%>
      <% end %>

    <% else %>

      <%= form_for @post, method: :put, html: { id: 'PublishPost', class: %w(button publish) } do |f| %>
        <%= f.button 'Publish', value: 'publish'%>
      <% end %>

      <%= form_for @post, method: :delete, html: { id: 'DeletePost', class: %w(destroy button), as: 'Post.Delete' } do |f| %>
        <%= f.button disabled: true do %>
          <%= check_box_tag 'delete' %>
          Delete this post
        <% end %>
      <% end %>

    <% end %>

  <% end %>

  <article>
    <%= content_tag :header, as: "Post.Header" do |header| %>
      <% if @post.header? %>
        <% header[:style] = "background-image: url(#{@post.header.url});" %>
      <% end %>

      <%= render 'admin/images/form', post: @post %>
    <% end %>

    <%= post_edit_content(@post) %>
  </article>

  <div class='save' as='Post.Sticky'>
    <%= form_for @post, method: :put, remote: true, html: {as: 'Editor.Save', class: %w(save button)} do |f| %>
      <%= f.button '', dirty: 'Update', persisted: 'Up to date', disabled: true %>
      <%= content_tag :div, class: %w(update) do %>
        Last updated
        <%= content_tag :p, nil, time: @post.updated_at.iso8601 %>
      <% end %>
    <% end %>

    <%= link_to 'Syntax', help_admin_posts_path, remote: true, class: %w(help) %>

    <% unless Rails.application.secrets.has_key?(:s3) %>
      <div class='s3 configuration missing'>
        <%= link_to 'Configure S3 to upload images.', admin_configurations_images_path %>
      </div>
    <% end %>
  </div>

</section>
